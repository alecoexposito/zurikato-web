<audio id="panicAlarmAudio">
    <source src="audio/panic-alarm.mp3">
</audio>
<audio id="speedAlarmAudio">
    <source src="audio/speed-alarm.mp3">
</audio>

<div class="container-fluid">
    <div class="minmaxCon">
        <div class="modal fade mymodal" id="watchVideoModal" tabindex="-1" role="dialog" aria-labelledby="watchVideoModal"
         aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Camara del veh&iacute;culo</h5>
                    <button type="button" class="close modalMinimize" style="font-size: 16px"> <i class='fa fa-minus fa-sm'></i> </button>
                    <button type="button" class="close minimize-close" data-dismiss="modal" aria-label="Close" style="margin-left: 5px; font-size: 16px;">
                        <i class="fa fa-times fa-sm"></i>
                    </button>
                </div>
                <!--<div class="modal-body row">-->
                    <!--<video id="video1" class="video-js vjs-default-skin" width="540" height="360" controls preload="auto" >-->
                        <!--<source src="http://187.162.125.161:3009/hls/bb23/test.m3u8" type="application/x-mpegURL">-->
                    <!--</video>-->
                <!--</div>-->

                <div class="modal-body row">
                    <img id="cameraImage" height="400" src="" style="width: 100%;"/>
                </div>

                <div class="modal-footer">
                    <!--<button type="button" class="btn btn-primary" ng-click="$ctrl.generateSharedLink()">-->
                        <!--<i class="fa fa-check"></i> Generar-->
                    <!--</button>-->
                    <button type="button" class="btn btn-secondary" ng-click="$ctrl.makeFullScreen('cameraImage')" ><i class="fa fa-square"></i> Pantalla completa</button>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal"><i class="fa fa-times"></i> Cerrar</button>
                </div>
            </div>
        </div>
    </div>
    </div>
    <div class="minmaxCon">
        <div class="modal fade mymodal" id="watchVideoBackupModal" tabindex="-1" role="dialog" aria-labelledby="watchVideoBackupModal"
             aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Grabaci&oacute;n</h5>
                        <button type="button" class="close modalMinimize" style="font-size: 16px"> <i class='fa fa-minus fa-sm'></i> </button>

                        <button type="button" class="close minimize-close" style="font-size: 16px; margin-left: 5px;" data-dismiss="modal" aria-label="Close">
                            <i class="fa fa-times fa-sm"></i>
                        </button>
                    </div>
                    <div id="video-modal-body" class="modal-body row">
                        <div id="no-video-message" class="col-12" style="display: none">
                            <h3>No hay grabaciones en el rango de fecha especificado</h3>
                        </div>
                        <div id="video-dates-div" class="col-12 pb-2">
                            <button id="video-dates" type="text" class="btn btn-primary mt-1">Escoger rango de fechas</button>
                        </div>

                        <div id="waitingVideo" class="col-12 text-center" style="display: none;">
                            <i class="fa fa-spinner fa-spin fa-4x text-center"></i>
                        </div>
                        <video id="videoToClone" class="video-js vjs-default-skin" width="540" height="360" controls preload="auto" style="display: none;" >
                            <source src="" type="application/x-mpegURL">
                        </video>

                        <video id="video1" class="video-js vjs-default-skin" width="540" height="360" controls preload="auto" style="display: none;" >
                            <source src="" type="application/x-mpegURL">
                        </video>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal"><i class="fa fa-times"></i> Cerrar</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="createShareLink" tabindex="-1" role="dialog" aria-labelledby="createShareLink"
         aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Compartir vehículos</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body fow">
                    <div class="col-lg-6">
                        <div class="form-group">
                            <label>Fecha de expiración</label>
                            <input type="text" id="shareDate" class="form-control"/>
                        </div>
                    </div>
                    <div class="col-lg-12">
                        <div class="form-group">
                            <label>Vehículos a mostrar</label>
                            <select type="text" id="chosenDevices" class="form-control" multiple="true"></select>
                        </div>
                    </div>
                    <div class="col-lg-12 text-lg-center">
                        <span id="load-link" style="display: none;"><i class="fa fa-spinner fa-spin"></i> Generando...</span>
                    </div>
                    <div id="show-link" class="col-lg-12" style="display: none;">
                        <label>La url ha sido generada, copiela utilizando el botón de copiar</label>
                        <div class="input-group">
                            <input id="shared-link" class="text-muted border p-1 form-control" readonly>
                            <div class="input-group-append">
                                <button id="copy-button" class="btn btn-primary" type="button"><i class="fa fa-copy"></i> Copiar</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" ng-click="$ctrl.generateSharedLink()">
                        <i class="fa fa-check"></i> Generar
                    </button>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal"><i class="fa fa-times"></i> Cerrar</button>
                    <!--<a id="modal-historical" target="_blank" href="" class="btn btn-primary"><i class="fa fa-road"> Watch historical</i></a>-->
                </div>
            </div>
        </div>

    </div>
    <div class="modal fade" id="automaticWaitIntervalModal" tabindex="-1" role="dialog" aria-labelledby="automaticWaitInterval"
         aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Tiempo en segundos en que el dispositivo se quedar&aacute; activo</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Cerrar">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body fow">
                    <div class="col-4 offset-3">
                        <input type="number" id="automaticWaitInterval" value="{{$ctrl.automaticTime / 1000}}"/>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-dismiss="modal" ng-click="$ctrl.setIntervalToMarker()">
                        <i class="fa fa-check"></i> Aceptar
                    </button>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal"><i class="fa fa-times"></i> Cerrar</button>
                    <!--<a id="modal-historical" target="_blank" href="" class="btn btn-primary"><i class="fa fa-road"> Watch historical</i></a>-->
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="fencesModal" tabindex="-1" role="dialog" aria-labelledby="deviceGeofencesModal"
         aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Choose the geofences this device will be registered to</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body fow">
                    <div class="col-12">
                        <ul id="fence-list" class="list-group">
                            <li class="list-group-item" ng-repeat="fence in $ctrl.fences" fence-index="{{$index}}">{{fence.title}}
                                <div class="btn-group btn-group-sm btn-group-toggle float-right" data-toggle="buttons">
                                    <label class="btn btn-outline-secondary">
                                        <input class="enter-alarm" type="radio" name="options" id="enterAlarm" autocomplete="off"> Al entrar
                                    </label>
                                    <label class="btn btn-outline-secondary">
                                        <input class="exit-alarm" type="radio" name="options" id="exitAlarm" autocomplete="off"> Al salir
                                    </label>
                                    <button class="btn btn-sm btn-outline-dark clear-radios-button"><i class="fa fa-times"></i></button>
                                    <!--<button class="btn btn-sm btn-outline-primary">Al salir</button>-->
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-dismiss="modal" ng-click="$ctrl.setDevicesToFences()">
                        <i class="fa fa-check"></i> Aceptar
                    </button>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal"><i class="fa fa-times"></i> Cancelar</button>
                    <!--<a id="modal-historical" target="_blank" href="" class="btn btn-primary"><i class="fa fa-road"> Watch historical</i></a>-->
                </div>
            </div>
        </div>

    </div>
    <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
         aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Select date range</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <button ng-click="$ctrl.historicalRangeClick('today')" class="btn btn-small btn-primary"><i
                            class="fa fa-calendar-check"></i> Today
                    </button>
                    <button ng-click="$ctrl.historicalRangeClick('yesterday')" class="btn btn-small btn-primary"
                            href=""><i class="fa fa-calendar"></i> Yesterday
                    </button>
                    <button id="historical-custom" class="btn btn-small btn-primary"
                            ng-click="$ctrl.historicalCustomClick()">
                        <i class="fa fa-road"></i> Custom
                    </button>

                    <input id="historical-dates" type="text" class="form-control mt-1" style="display: none;"/>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal"><i class="fa fa-times"></i> Close</button>
                    <!--<a id="modal-historical" target="_blank" href="" class="btn btn-primary"><i class="fa fa-road"> Watch historical</i></a>-->
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="cameraAutoplay" tabindex="-1" role="dialog" aria-labelledby="cameraAutoplay"
         aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Autom&aacute;tico de c&aacute;mara</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body fow">
                    <div class="form-group">
                        <label for="isInAutoplay" style="cursor: pointer;" ><input type="checkbox" id="isInAutoplay"> Incluir esta camara en el autom&aacute;tico </label>
                    </div>
                    <div class="form-group">
                        <label for="cameraShowInterval">Intervalo en el que saldr&aacute; la imagen</label>
                        <input type="number" id="cameraShowInterval" value=""/>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-dismiss="modal" ng-click="$ctrl.setIntervalToCamera()">
                        <i class="fa fa-check"></i> Aceptar
                    </button>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal"><i class="fa fa-times"></i> Cerrar</button>
                    <!--<a id="modal-historical" target="_blank" href="" class="btn btn-primary"><i class="fa fa-road"> Watch historical</i></a>-->
                </div>
            </div>
        </div>
    </div>


    <div id="device-menu-options" class="toolbar-icons hidden">
        <a data-toggle="modal" data-target="#myModal" href="">
            <i class="fa fa-road"></i>
        </a>
        <a href="" data-toggle="modal" data-target="#automaticWaitIntervalModal">
            <i class="fa fa-clock"></i>
        </a>
        <a href="" data-toggle="modal" data-target="#fencesModal">
            <i class="fa fa-ban"></i>
        </a>
        <a href="" data-toggle="modal" data-target="#createShareLink">
            <i class="fa fa-share-square"></i>
        </a>
        <a id="device-charts" href="/device/{{ ctrl.currentIdDevice }}/charts">
            <i class="fa fa-chart-line"></i>
        </a>
        <a href="" id="menu-device-camera" class="video-option" data-id="{{ ctrl.currentIdDevice }}" >
            <i class="fa fa-camera"></i>
        </a>
        <a href="" id="menu-device-video" class="video-backup-option" data-id="{{ ctrl.currentIdDevice }}" data-toggle="modal" data-target="#watchVideoBackupModal" >
            <i class="fa fa-video"></i>
        </a>
        <!--<a href="" id="menu-device-obd" class="obd-menu-item" data-id="{{ ctrl.currentIdDevice }}" >-->
            <!--<i class="fa fa-car"></i>-->
        <!--</a>-->
    </div>

    <div id="camera-menu-options" class="toolbar-icons hidden">
        <a href="" id="menu-camera-camera" class="video-option" data-id="{{ ctrl.currentIdDevice }}" data-toggle="modal" data-target="#watchVideoModal" >
            <i class="fa fa-camera"></i>
        </a>
        <a href="" id="menu-camera-video" class="video-backup-option" data-id="{{ ctrl.currentIdDevice }}" data-toggle="modal" data-target="#watchVideoBackupModal" >
            <i class="fa fa-video"></i>
        </a>
        <a href="" data-toggle="modal" data-target="#cameraAutoplay">
            <i class="fa fa-clock"></i>
        </a>
        <!--<a href="" id="menu-device-obd" class="obd-menu-item" data-id="{{ ctrl.currentIdDevice }}" >-->
        <!--<i class="fa fa-car"></i>-->
        <!--</a>-->
    </div>


    <!--<div id="beforeMap">-->
        <!--<h4>Probando esto</h4>-->
    <!--</div>-->
    <!--Body content-->
    <div id="map" class="index-map font" map-lazy-load="https://maps.google.com/maps/api/js"
         map-lazy-load-params="{{$ctrl.googleMapsUrl}}" style="width: 100% !important;">
        <ng-map center="[{{$ctrl.initialLatitude}}, {{$ctrl.initialLongitude}}]" zoom="10">
            <custom-control id="address-control" position="TOP_CENTER" index="2" class="justify-content-center"
                            style="max-width: 50%;position: center; display: none;">
                <div class="rounded-bottom" style="opacity: 0.7;">
                    <p class="p-1 text-center" id="address-p" style="color: white; font-size: 14px"><i
                            class="fa fa-spinner fa-spin"></i> cargando...</p>
                </div>
            </custom-control>
            <custom-control id="toggle-automatic" position="LEFT" index="2" class="ml-3 mb-3">
                <button id='toggle-automatic-button' class="btn btn-secondary btn-small" ng-click="$ctrl.toggleAutomatic()">
                    <i class="fa fa-play-circle"></i>
                </button>
            </custom-control>
            <custom-control id="triguer-control" position="LEFT" index="2" class="ml-3 mb-3"
                            on-click="$ctrl.displayHideMenu()">
                <button id='trigger' class="btn btn-secondary btn-small">
                    <i class="fa fa-bars"></i></button>
            </custom-control>
            <custom-control id="right-menu" position="TOP_RIGHT" index="1">
                <div class="mr-3 mt-3">
                    <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton"
                            data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <i class="fa fa-user"></i>
                    </button>
                    <div class="dropdown-menu dropdown-menu-right" aria-labelledby="dropdownMenuButton" class="mr-3">
                        <!--<a class="dropdown-item" href="#!/login">Log out</a>-->
                        <a class="dropdown-item" ng-click="$ctrl.logOutOption()" style="cursor: pointer;">Log out</a>
                    </div>
                </div>
            </custom-control>
            <custom-control class="large-text" id="left-menu-control" position="LEFT" index="1" style="height: 100%">
                <div id="left-menu" style="height: 100%">
                    <div id="treeMenu" style="overflow-y: scroll; max-height: 58%">

                    </div>
                </div>
            </custom-control>
            <custom-control id="detail-control" position="BOTTOM_CENTER" index="2"
                            class="rounded-top justify-content-center"
                            style="opacity: 0.7; position: center; display: none;">
                <div class="p-1 rounded-top" style="color: #ffffff;">

                </div>
            </custom-control>
            <custom-control id="fence-control" style="z-index: 2000" class="mt-1" position="TOP_LEFT">
                <button id="enableFenceEditionButton" type="button" class="btn btn-sm btn-secondary" ng-click="$ctrl.enableFenceEditionMode()"><i class="fa fa-ban"></i> Editar Geofences</button>
                <button type="button" style="display: none; z-index: 2000;" class="fence-edit-btn btn btn-sm btn-secondary" ng-click="$ctrl.updateFences()"><i id="saveFencesIcon" class="fa fa-check"></i> Guardar</button>
                <button type="button" style="display: none; z-index: 2000;" class="fence-edit-btn btn btn-sm btn-secondary" ng-click="$ctrl.disableFenceEditionMode()"><i class="fa fa-times"></i> Cancelar</button>
            </custom-control>
            <!--<custom-control id="test-control" position="TOP_LEFT" on-click="$ctrl.test()">-->
                <!--<button type="button" class="btn btn-sm btn-secondary">Test</button>-->
            <!--</custom-control>-->

            <drawing-manager id="fenceDrawer"
                    on-overlaycomplete="$ctrl.addFeatureToData()"
                    on-polygoncomplete="$ctrl.addFencePolygon()"
                    drawing-control-options="{position: 'CENTER_RIGHT',drawingModes:['polygon']}"
                    drawingControl="false"
                    drawingMode="null"
                    markerOptions="{icon:'www.example.com/icon'}"
                    polygonOptions="{fillColor: 'red', strokeWeight: 1, editable: true, draggable: true}",
            </drawing-manager>

        </ng-map>
    </div>


</div>
<!--</div>-->
